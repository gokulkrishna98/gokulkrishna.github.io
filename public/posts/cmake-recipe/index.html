<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CmAKE-recipe ðŸŽ‚ | Gokul's Website</title>
<meta name=keywords content><meta name=description content="Introduction
As you know, CMake is a build systems that allows us to compile large code files, libraries and versioning with
with set of rules and giving us the power to configure the build. Let us see how to do CMAKE to build some systems. CMake is mostly used for compiling C and C++ codebases, and I will be using C++ here.
I followed the official tutorial, please look at it. This just my notes and peasant level understanding."><meta name=author content="Gokul"><link rel=canonical href=http://localhost:1313/posts/cmake-recipe/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/cmake-recipe/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/cmake-recipe/"><meta property="og:site_name" content="Gokul's Website"><meta property="og:title" content="CmAKE-recipe ðŸŽ‚"><meta property="og:description" content="Introduction As you know, CMake is a build systems that allows us to compile large code files, libraries and versioning with with set of rules and giving us the power to configure the build. Let us see how to do CMAKE to build some systems. CMake is mostly used for compiling C and C++ codebases, and I will be using C++ here. I followed the official tutorial, please look at it. This just my notes and peasant level understanding."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-07T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-07T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="CmAKE-recipe ðŸŽ‚"><meta name=twitter:description content="Introduction
As you know, CMake is a build systems that allows us to compile large code files, libraries and versioning with
with set of rules and giving us the power to configure the build. Let us see how to do CMAKE to build some systems. CMake is mostly used for compiling C and C++ codebases, and I will be using C++ here.
I followed the official tutorial, please look at it. This just my notes and peasant level understanding."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"CmAKE-recipe ðŸŽ‚","item":"http://localhost:1313/posts/cmake-recipe/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CmAKE-recipe ðŸŽ‚","name":"CmAKE-recipe ðŸŽ‚","description":"Introduction As you know, CMake is a build systems that allows us to compile large code files, libraries and versioning with with set of rules and giving us the power to configure the build. Let us see how to do CMAKE to build some systems. CMake is mostly used for compiling C and C++ codebases, and I will be using C++ here. I followed the official tutorial, please look at it. This just my notes and peasant level understanding.\n","keywords":[],"articleBody":"Introduction As you know, CMake is a build systems that allows us to compile large code files, libraries and versioning with with set of rules and giving us the power to configure the build. Let us see how to do CMAKE to build some systems. CMake is mostly used for compiling C and C++ codebases, and I will be using C++ here. I followed the official tutorial, please look at it. This just my notes and peasant level understanding.\nPrerequisites Have CMake Installed, C++/C basics. check using cmake --version, gcc --version.\nCompiling Single File In this project we have two files tutorial.cpp and tutorial.h, indicating the source file and header file for the source file. What do we want to accompilish here:\nVersion of the coder repo (2.1, 1.4 etc) Tell what version standard c++ to use (c++11, c++14, c++17) Build an executabe with a Before starting let us have two files draw.cpp and draw.h. We create a file named CMakeLists.txt which will do the above mentioned steps.\nVersioning The versioning is usually two numbers: major version number and minor version number. Small incremental updates are done through minor version number and big substantial changes are done through major version number. The convention is major_num . minor_um eg: 2.1, 4.2 etc. To do this first we have to mention project name and the version number, add the following in CMakefile.\nproject(Draw VERSION 1.0) Now we may have to add this info to our cxx file for printing, debugging so we can access it in our program. This can be done via preprocessor directives using header file. CMake gives us a automatic way to create this header file by writing a input file to cmake. To do this create config.h.in file for config and add the following\n#define Draw_VERSION_MAJOR @Draw_VERSION_MAJOR@ #define Draw_VERSION_MINOR @Draw_VERSION_MINOR@ Then add the following in CMakeLists to use config_file function\nconfigure_file(config.h.in config.h) we can use these variables in our program by including the config.h file, which will be created during cmake build step.\nSetting C++ standard We have option to tell cmake to use which c++ standard for the project. We can also tell if this requirement needs to be strict or optional. To do this add the following:\nset(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_STANDARD_REQUIRED True) Building executable To do this we need to do two things:\nmention the include directory. mention the binary name. To do this add the following:\nadd_executable(Draw draw.cpp) target_include_directories(Draw PUBLIC \"${PROJECT_BINARY_DIR}\") Let us look at the second command and what it does (target here means Draw):\nDraw: This is the name of the target (likely an executable or library) that youâ€™re specifying the include directories for. PUBLIC: This keyword specifies that the include directories should be used by the target and all of its dependents. That is it dictates visibility of the Target. \"${PROJECT_BINARY_DIR}\": This is a CMake variable that represents the binary directory of the project. Itâ€™s where the compiled executables and libraries are stored. There are lot of CMake versions, some are not backwards compatible, so we can mention CMake requirement in our build file. To do that add the following\ncmake_minimum_required(VERSION 3.22.1) The overal file will look somewhat like this:\ncmake_minimum_required(VERSION 3.22.1) project(Draw VERSION 1.0) configure_file(config.h.in config.h) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_STANDARD_REQUIRED True) add_executable(Draw draw.cpp) target_include_directories(Draw PUBLIC \"${PROJECT_BINARY_DIR}\") now create a folder called build and go there. Then run the following commands to build.\ncmake cmake --build . Let us see how to add Library to our single executable project. say we have a library called shapes which has files shapes.h, myshapes.cc and myshapes.h and CMakeLists.txt for the library. File directory will look something like this.\n. â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ draw.cpp â”œâ”€â”€ draw.h â””â”€â”€ shapes â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ shapes.cc â”œâ”€â”€ shapes.h â”œâ”€â”€ myshapes.cc â””â”€â”€ myshapes.h 1 directory, 7 files Let us first write the CMakeLists for both files:\nouter CMakeLists.txt\ncmake_minimum_required(VERSION 3.10) project(Draw VERSION 1.0) set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_STANDARD_REQUIRED True) configure_file(config.h.in config.h) add_subdirectory(shapes) add_executable(Draw draw.cpp) target_link_libraries(Draw PUBLIC shapes) target_include_directories(Draw PUBLIC \"${PROJECT_SOURCE_DIR}/shapes\") target_include_directories(Tutorial PUBLIC \"${PROJECT_BINARY_DIR}\") We have to see two functions here: target_link_libraries and target_include_directories. The first function tells how to build executable and the second function tells compiler where to find the header files.\nthe target_include_directories(Draw PUBLIC \"${PROJECT_SOURCE_DIR}/shapes\") breakdown:\ntarget_include_directories: This function is used to specify include directories for a target (in this case, Draw). PUBLIC: This specifies that the include directories should be used for the target itself, as well as any of its dependents (i.e., other targets that link to Draw). \"${PROJECT_SOURCE_DIR}/shapes\": This is the path to the include directory. ${PROJECT_SOURCE_DIR} is a CMake variable that represents the root directory of the current project. /shapes is a subdirectory of that root directory. The inner CMakeLists.txt\nadd_library(shapes shapes.cc) option(USE_MYSHAPES \"using my implementation of shapes\" ON) if(USE_MYSHAPES) target_compile_definitions(shapes PRIVATE \"USE_MYSHAPES\") add_library(myshapes STATIC myshapes.cxx) target_link_libraries(shapes PRIVATE myshapes) endif() Here we try to add a sublibrary myshapes to the library shapes and keep the visibility private (as outer functions can access it only via shapes).\nWe give the option to choose to use this sublibrary by creating a option variable called USE_MYSHAPES. We can pass this option variable to cpp files through target_compile_definitions (via preprocess directives). We use the same target_link_libraries to link the sublibrary to the library.\n","wordCount":"863","inLanguage":"en","datePublished":"2024-03-07T00:00:00Z","dateModified":"2024-03-07T00:00:00Z","author":{"@type":"Person","name":"Gokul"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/cmake-recipe/"},"publisher":{"@type":"Organization","name":"Gokul's Website","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Gokul's Website (Alt + H)">Gokul's Website</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;Â»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">CmAKE-recipe ðŸŽ‚</h1><div class=post-meta><span title='2024-03-07 00:00:00 +0000 UTC'>March 7, 2024</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;863 words&nbsp;Â·&nbsp;Gokul</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#compiling-single-file>Compiling Single File</a></li></ul><ul><li><a href=#let-us-see-how-to-add-library-to-our-single-executable-project>Let us see how to add Library to our single executable project.</a></li></ul></nav></div></details></div><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>As you know, CMake is a build systems that allows us to compile large code files, libraries and versioning with
with set of rules and giving us the power to configure the build. Let us see how to do CMAKE to build some systems. CMake is mostly used for compiling C and C++ codebases, and I will be using C++ here.
I followed the official tutorial, please look at it. This just my notes and peasant level understanding.</p><h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h2><p>Have CMake Installed, C++/C basics. check using <code>cmake --version</code>, <code>gcc --version</code>.</p><h2 id=compiling-single-file>Compiling Single File<a hidden class=anchor aria-hidden=true href=#compiling-single-file>#</a></h2><p>In this project we have two files tutorial.cpp and tutorial.h, indicating the source file and header file for the source file. What do we want to accompilish here:</p><ul><li>Version of the coder repo (2.1, 1.4 etc)</li><li>Tell what version standard c++ to use (c++11, c++14, c++17)</li><li>Build an executabe with a</li></ul><p>Before starting let us have two files <code>draw.cpp</code> and <code>draw.h</code>. We create a file named <code>CMakeLists.txt</code> which will do the above mentioned steps.</p><h1 id=versioning>Versioning<a hidden class=anchor aria-hidden=true href=#versioning>#</a></h1><p>The versioning is usually two numbers: major version number and minor version number. Small incremental updates are done through minor version number and big substantial changes are done through major version number. The convention is <code>major_num . minor_um</code> eg: 2.1, 4.2 etc. To do this first we have to mention project name and the version number, add the following in CMakefile.</p><pre tabindex=0><code>project(Draw VERSION 1.0)
</code></pre><p>Now we may have to add this info to our cxx file for printing, debugging so we can access it in our program. This can be done via preprocessor directives using header file. CMake gives us a automatic way to create this header file by writing a input file to cmake. To do this create config.h.in file for config and add the following</p><pre tabindex=0><code>#define Draw_VERSION_MAJOR @Draw_VERSION_MAJOR@
#define Draw_VERSION_MINOR @Draw_VERSION_MINOR@
</code></pre><p>Then add the following in <code>CMakeLists</code> to use config_file function</p><pre tabindex=0><code>configure_file(config.h.in config.h)
</code></pre><p>we can use these variables in our program by including the config.h file, which will be created during cmake build step.</p><h1 id=setting-c-standard>Setting C++ standard<a hidden class=anchor aria-hidden=true href=#setting-c-standard>#</a></h1><p>We have option to tell cmake to use which c++ standard for the project. We can also tell if this requirement needs to be strict or optional. To do this add the following:</p><pre tabindex=0><code>set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED True)
</code></pre><h1 id=building-executable>Building executable<a hidden class=anchor aria-hidden=true href=#building-executable>#</a></h1><p>To do this we need to do two things:</p><ol><li>mention the include directory.</li><li>mention the binary name.</li></ol><p>To do this add the following:</p><pre tabindex=0><code>add_executable(Draw draw.cpp)
target_include_directories(Draw PUBLIC &#34;${PROJECT_BINARY_DIR}&#34;)
</code></pre><p>Let us look at the second command and what it does (target here means Draw):</p><ul><li><code>Draw</code>: This is the name of the target (likely an executable or library) that you&rsquo;re specifying the include directories for.</li><li><code>PUBLIC</code>: This keyword specifies that the include directories should be used by the target and all of its dependents. That is it dictates visibility of the Target.</li><li><code>"${PROJECT_BINARY_DIR}"</code>: This is a CMake variable that represents the binary directory of the project. It&rsquo;s where the compiled executables and libraries are stored.</li></ul><p>There are lot of CMake versions, some are not backwards compatible, so we can mention CMake requirement in our build file. To do that add the following</p><pre tabindex=0><code>cmake_minimum_required(VERSION 3.22.1)
</code></pre><p>The overal file will look somewhat like this:</p><pre tabindex=0><code>cmake_minimum_required(VERSION 3.22.1)

project(Draw VERSION 1.0)

configure_file(config.h.in config.h)

set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED True)

add_executable(Draw draw.cpp)
target_include_directories(Draw PUBLIC &#34;${PROJECT_BINARY_DIR}&#34;)
</code></pre><p>now create a folder called build and go there. Then run the following commands to build.</p><pre tabindex=0><code>cmake &lt;path to CMakeLists.txt&gt;
cmake --build .
</code></pre><h2 id=let-us-see-how-to-add-library-to-our-single-executable-project>Let us see how to add Library to our single executable project.<a hidden class=anchor aria-hidden=true href=#let-us-see-how-to-add-library-to-our-single-executable-project>#</a></h2><p>say we have a library called shapes which has files <code>shapes.h</code>, <code>myshapes.cc</code> and <code>myshapes.h</code> and <code>CMakeLists.txt</code> for the library. File directory will look something like this.</p><pre tabindex=0><code>.
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ draw.cpp
â”œâ”€â”€ draw.h
â””â”€â”€ shapes
    â”œâ”€â”€ CMakeLists.txt
    â”œâ”€â”€ shapes.cc
    â”œâ”€â”€ shapes.h
    â”œâ”€â”€ myshapes.cc
    â””â”€â”€ myshapes.h

1 directory, 7 files
</code></pre><p>Let us first write the CMakeLists for both files:</p><p>outer CMakeLists.txt</p><pre tabindex=0><code>cmake_minimum_required(VERSION 3.10)

project(Draw VERSION 1.0)

set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED True)

configure_file(config.h.in config.h)

add_subdirectory(shapes)

add_executable(Draw draw.cpp)

target_link_libraries(Draw PUBLIC shapes)    

target_include_directories(Draw PUBLIC &#34;${PROJECT_SOURCE_DIR}/shapes&#34;)

target_include_directories(Tutorial PUBLIC &#34;${PROJECT_BINARY_DIR}&#34;)
</code></pre><p>We have to see two functions here: <code>target_link_libraries</code> and <code>target_include_directories</code>. The first function tells how to build executable and the second function tells compiler where to find the header files.</p><p>the <code>target_include_directories(Draw PUBLIC "${PROJECT_SOURCE_DIR}/shapes")</code> breakdown:</p><ul><li><code>target_include_directories</code>: This function is used to specify include directories for a target (in this case, Draw).</li><li><code>PUBLIC</code>: This specifies that the include directories should be used for the target itself, as well as any of its dependents (i.e., other targets that link to Draw).</li><li><code>"${PROJECT_SOURCE_DIR}/shapes"</code>: This is the path to the include directory. ${PROJECT_SOURCE_DIR} is a CMake variable that represents the root directory of the current project. /shapes is a subdirectory of that root directory.</li></ul><p>The inner CMakeLists.txt</p><pre tabindex=0><code>add_library(shapes shapes.cc)

option(USE_MYSHAPES &#34;using my implementation of shapes&#34; ON) 

if(USE_MYSHAPES)
    target_compile_definitions(shapes PRIVATE &#34;USE_MYSHAPES&#34;)
    add_library(myshapes STATIC myshapes.cxx)
    target_link_libraries(shapes PRIVATE myshapes)
endif()
</code></pre><p>Here we try to add a sublibrary myshapes to the library shapes and keep the visibility private (as outer functions can access it only via shapes).</p><p>We give the option to choose to use this sublibrary by creating a option variable called <code>USE_MYSHAPES</code>. We can pass this option variable to cpp files through <code>target_compile_definitions</code> (via preprocess directives). We use the same <code>target_link_libraries</code> to link the sublibrary to the library.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Gokul's Website</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>